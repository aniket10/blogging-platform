<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>OSBlogger</title>
</head>
<body bgcolor="#003366">
    <font color="#FFFFFF" >
	<h1 >Open Source Blogger</h1><hr>
	</font>
	{% if login %} 
	    <form name = "login" action="logout.py" >
			<p align = right  >
			<font color="#FFFFFF" >Welcome {{ username }} </font>&nbsp;&nbsp;&nbsp;&nbsp;
			<input type="hidden" name="sessionId" value="{{sessionId}}" />
			<input type="submit" value="LogOut"/></p>
		</form>
 		<table align=center width="50%" bgcolor="#FFFFFF" cellpadding = "20">
 		<tr><td align=center>
	 		<a href="/NewPage.py?sessionId={{ sessionId }}"> Create New Blog</a><br>
	 		{% if ubcount > 0 %}
		 		<form name="AddPost" action="/NewBlog.py" >
		 		    Add Post to an existing Blog:
		 			<input type = "hidden" name="sessionId" value= "{{sessionId}}" />
		 			<select name="PageName">
		 			   {% for ub in userblogs %}
		 			     {{ ub.page_name }}
		 				<option name="{{ ub.page_name }}" value="{{ub.key().id()}}">{{ub.page_name}}</option>
		 			   {% endfor %}	 
		 			</select> 
		 			<input type="submit" name="addPost" value="Create Post" />
		 		</form>
	 		{% else %}
	 			You Donot Own any Blog Page. Create a Blog Page First.
	 		{% endif %}
		{% else %}
		    <table align=center width="50%" bgcolor="#FFFFFF">
 		     <tr><td align=center>
			<a href={{ login_url }} > Login </a> to create a new Blog or Add a post to your Blog
		{% endif %}
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<br><br>
		Search for blogs using hashtags or owner or BlogName. 
		<form name = "search" action="BlogFeed.py">
			<input type="text" name="query">
			as
			<select name="type">
				<option value='tags'>Hash Tags</option>
				<option value='owner'>Owner</option>
				<option value='blog'>Blog Name</option> 
			</select><br>		
			<input type="hidden" name="page" value="1"/>
			<input type="hidden" name="sessionId" value={{ sessionId }} />
			<input type="submit" value="Search">	
		</form>
		<br>
		<hr>
	</td></tr>
	<tr><td>
	    {% if login == 1 %}
		<h3>Aggregated Blog Feed</h3>
		{% endif %}
		{% for d,c,cn in display_listnComments %}
		     <hr>
		     <h3><a href=showCompleteBlog.py?blogid={{ d.key().id() }}&sessionId={{sessionId}}>{{ d.title }}</a></h3>
		     By {{ d.owner }} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		     <h5> Created on:{{ d.create_time }}</h5>
		     <h5> Last Updated on:{{ d.modify_time }}</h5>	  
		     {% if cn|length <= 500 %}
		         {{ cn }}<br>
		     {% else %}
		         {{ cn[:500] }}
		         ... &nbsp;&nbsp;&nbsp;
		         <a href=showCompleteBlog.py?blogid={{ d.key().id() }}&sessionId={{ sessionId }}>more</a>
		         <br>
		     {% endif %}
		     Tags : 
		     {% if d.tag1 != "" %}
		     	<a href=/BlogFeed.py?query={{ d.tag1 }}&type=tags&page=1&sessionId={{ sessionId }}>{{ d.tag1 }}</a>
		     	&nbsp;&nbsp;
		     {% endif %}
		     
		     {% if d.tag2 != "" %}
		     	|&nbsp;&nbsp;
		     	<a href=/BlogFeed.py?query={{ d.tag2 }}&type=tags&page=1&sessionId={{ sessionId }}>{{ d.tag2 }}</a>
		     	&nbsp;&nbsp;
		     {% endif %}
		     
		     {% if d.tag3 != "" %}
		     	|&nbsp;&nbsp;
		     	<a href=/BlogFeed.py?query={{ d.tag3 }}&type=tags&page=1&sessionId={{ sessionId }}>{{ d.tag3 }}</a>
		     	&nbsp;&nbsp;
		     {% endif %}
		     
		     {% if d.tag4 != "" %}
		     	|&nbsp;&nbsp;
		     	<a href=/BlogFeed.py?query={{ d.tag4 }}&type=tags&page=1&sessionId={{ sessionId }}>{{ d.tag4 }}</a>
		     	&nbsp;&nbsp;
		     {% endif %}
		     
		     {% if d.tag5 != "" %}
		     	|&nbsp;&nbsp;
		     	<a href=/BlogFeed.py?query={{ d.tag5 }}&type=tags&page=1&sessionId={{ sessionId }}>{{ d.tag5 }}</a>
		     	&nbsp;&nbsp;
		     {% endif %}
		     <br><br>
		     {{ d.thumbsup }} Thumbs-Up &nbsp;&nbsp;&nbsp;&nbsp;{{ d.thumbsdown }} Thumbs-Down &nbsp;&nbsp;&nbsp;&nbsp;{{ c }} Comments
		     <br><br>
		     <table>
		     	<tr>
		     		<td><form name="thumbsupform" action="/addThumbsUp.py" >
			     			<input type="hidden" name="blogid" value="{{ d.key().id() }}" />
			     			<input type="hidden" name="dest_url" value="{{ cur_url }}" />
			     			<input type="hidden" name="sessionId" value="{{ sessionId }}" />
			     			<input type="submit" value="Thumbs-Up" />
		     		    </form>
		     		</td>
		     		<td><form name="thumbsdownform" action="/addThumbsDown.py" >
			     			<input type="hidden" name="blogid" value="{{ d.key().id() }}" />
			     			<input type="hidden" name="dest_url" value="{{ cur_url }}" />
			     			<input type="hidden" name="sessionId" value="{{ sessionId }}" />
			     			<input type="submit" value="Thumbs-Down" />
		     		    </form>
		     		</td>
		     		<td><form name="commentform" action="showCompleteBlog.py" >
			     			<input type="hidden" name="blogid" value="{{ d.key().id() }}" />
			     			<input type="hidden" name="dest_url" value="{{ cur_url }}" />
			     			<input type="hidden" name="sessionId" value="{{ sessionId }}" />
			     			<input type="submit" value="Comment" />
		     		    </form>
		     		</td>	     		
		     </table>
		     
		{% endfor %}
	</td></tr></table>
</body>
</html>